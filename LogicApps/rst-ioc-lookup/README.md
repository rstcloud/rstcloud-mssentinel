# Azure Logic App: Threat Intelligence Enrichment Playbook - RST Noise Control

## Summary

The provided Azure Logic App, titled "Enrich multiple entities - RST IoC Lookup," aims to automate threat intelligence enrichment for incidents generated by Microsoft Sentinel. This playbook integrates with the RST Cloud API to enrich IP addresses, domains, URLs, and file hashes, providing detailed information about potential threats.

## User Instructions

Follow these steps to set up and customise the playbook:

1. **Microsoft Sentinel Connection:**

   - Ensure the Microsoft Sentinel connection is configured in the `$connections` parameter and `connectionId`, `connectionName`, and `id` parameters are updated with the actual values.

2. **RST Cloud API Key:**

   - Replace `"YOUR_RST_API_KEY"` in the `rst_api_key` parameter with your actual RST Cloud API key.

3. **Trusted Entities:**

   - Adjust the `trusted_domains`, `trusted_ips`, and `trusted_urls` parameters with your organisation's trusted entities.

4. **Review and Customise Actions:**

   - Review each "For Each" section (IP, URL, Hash) and adjust the actions based on your specific requirements.

5. **Deploy Logic App:**
   - Save and deploy the Logic App in your Azure environment.

## Playbook Functionality

- **Enrichment:** Utilises the RST Cloud API to fetch threat intelligence for IPs, domains, URLs, and file hashes associated with incidents.

- **Conditional Processing:** Includes logic to skip checking trusted and internal entities, optimising the enrichment process.

- **Comment Integration:** Adds enriched threat intelligence information as comments to the corresponding Microsoft Sentinel incidents.

- **Modular Design:** Separates processing for IP, URL, and hash entities, allowing for easy customisation and maintenance.

## Additional Notes

- **Author:** Yury Sergeev
- **Categories:** Security - Automation (SOAR)
- **Release Version:** 1.0.0
- **Community Support Tier**

This playbook provides a foundation for automating threat intelligence enrichment in Microsoft Sentinel, enhancing incident response capabilities. Adapt and extend the playbook to align with your organisation's specific threat intelligence and incident handling workflows.
